scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))
g9
summary(fit9)
fit9<-lm(mpg~hp+am,data=mtcars)
summary(fit9)
g9=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2],size=1,color="Blue")+
geom_line(data=grid)+
stat_smooth(method="lm",level=0.95,fullrange=TRUE)+
scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))
g9
summary(fit1)
summary(fit9)
fit9$coeficients
fit9$coefficients
fit1$coefficients
ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)
g9=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2],size=1,color="Blue")+
)
g9=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2],size=1,color="Blue")+
g9=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2],size=1,color="Blue")
g9=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2],size=1,color="Blue")
ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2],size=1,color="Blue")
g9=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2],size=1,color="Blue")+
stat_smooth(method="lm",level=0.95,fullrange=TRUE)+
scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))
g9
summary(fit9)
g9=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="Figure 2: Mpg by hp and transmision")+
geom_point(size=6)+
geom_abline(intercept=coef(fit9)[1],slope=coef(fit9)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit9)[1]+coef(fit9)[3],slope=coef(fit9)[2],size=1,color="Blue")+
stat_smooth(method="lm",level=0.95,fullrange=TRUE)+
scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))
g9
g3
g2
g1
g9
grid.arrange(g1, g9, ncol = 2, main = "Main title")
summary(fit1)
summary(fit9)
grid.arrange(g1, g2, ncol = 2, main = "Exploratory analysis")
install_from_swirl("Regression Models")
install.packages("swirl")
install.packages("swirl")
install_from_swirl("Regression Models")
library(swirl)
swirl()
plot(child ~ parent, galton)
plot(jitter(child,4) ~
| parent,galton)
plot(jitter(child,4) ~ parent,galton)
regrline <- lm(child ~ parent, galton)
abline(regrline, lwd=3, col='red')
" to examine the Galton regression line. Do
| this now.
summary(regrline)
swirl()
plot(child ~ parent, galton)
plot(jitter(child,4) ~ parent,galton)
regrline <- lm(child ~ parent, galton)
abline(regrline, lwd=3, col='red')
summary(regrline)
swirl()
swirl()
swirl()
lm(child ~ parent,dataset)
fit<-lm(child ~ parent,dataset)
fit<-lm(child ~ parent,data=dataset)
fit<-lm(child ~ parent,data=Galton)
fit<-lm(child ~ parent,Galton)
swirl()
fit<-lm(child ~ parent,data=Galton)
fit<-lm(child ~ parent,data=galton)
summary(fit)
fit$residuals
mean(fit$residuals)
cov(fit$residuals, galton$parent)
ols.ic<-fit$coef[1]
ols.slope<-fit$coef[2]
rhs-lhs
lhs-rhs
all.equal(lhs,rhs)
varChild<-var(galton$childs)
varChild<-var(galton$child)
varRes<-var(fit$residuals)
varEst<-var(est(old.slope,old.ic))
varEst<-var(est(old.slope,ols.ic))
varEst<-var(est(ols.slope,ols.ic))
all.equal(varChild,varRes+varEst)
Type efit <- lm(accel ~ mag+dist, attenu)
efit <- lm(accel ~ mag+dist, attenu)
mean(efit)
mean(efit$residuals)
cov(efit$residuals,attenu$mag)
cov(efit$residuals,attenu$dist)
cor(gpa_nor,gch_nor)
l:nor<-lm(galton$child~galton$parent)
l:nor<-lm(gch_nor~gpa_nor)
l_nor<-lm(gch_nor~gpa_nor)
swirl()
swirl()
fit<-lm(child ~ parent,data=galton)
(fit$residuals)^2/n-2
sqrt(sum(fit$residuals^2) / (n - 2))
summary(fit)$sigma
deviance(fit)/(n-2)
sqrt(deviance(fit)/(n-2))
mu<-mean(galton$child)
sTot<-sum(galton$child-mu)^2
sTot <- sum((galton$child-mu)^2)
sRes<-dev()
sRes<-devianve()
sRes<-deviance()
sRes<-deviance(sum(fit$residuals^2))
sRes<-deviance(sum(res^2))
skip()
1-sRes/sTot
summary(fit)$r.squared
cor(galton$child,galton$parent)
cor(galton$parent,galton$child)^2
ones <- rep(1, nrow(galton))
lm(child ~ ones +parent -1, galton)
lm(child ~ parent, galton)
lm(child ~ 1, galton)
View(trees)
fit <- lm(Volume ~ Girth + Height + Constant -1, trees)
trees2<- eliminate("Girth", trees)
head(trees2)
fit2 <- lm(Volume ~ Height + Constant -1, trees2)
lapply(list(fit, fit2), coef)
lm(Fertility~.,data=swiss)
all <- lm(Fertility ~ ., swiss)
summary(all)
summary(lm(Fertility ~ Agriculture, swiss))
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelms(Agriculture~.)
makelms(Agriculture)
makelms()
ec<-sum(swiss$Examination,swiss$Catholic)
ec <- swiss$Examination+swiss$Catholic
efit <- lm(Fertility~.+ec)
efit <- lm(Fertility~.+ec,data=swiss)
ec-efit
skip()
s<-0
plot(cars$dist - mean(cars$dist), cars$speed - mean(cars$speed))
abline(0, s)
cars
plot(cars$dist - mean(cars$dist), cars$speed - mean(cars$speed))
plot(cars$dist, cars$speed
)
cars$dist
cars$speed
cars
plot(cars$mpg, cars$cyl)
abline(0,1)
abline(1,1)
?abline
abline(0,1)
install.packages("shiny")
library(shiny)
version
wd
getwd()
setwd()
setwd(/Users/nacho/project)
setwd("/Users/nacho/project")
getwd()
runApp()
getwd()
setwd("/Users/nacho/Project.Data_product")
runApp()
runApp()
?sample
car
data(cars)
cars
mtcars
dim(mtcars)
data(galton)
data(galton_childs)
data(galtonchilds)
library(manipulate) myHist <- function(mu){    hist(galton$child,col="blue",breaks=100) lines(c(mu, mu), c(0, 150),col="red",lwd=5) mse <- mean((galton$child - mu)^2) text(63, 150, paste("mu = ", mu))    text(63, 140, paste("MSE = ", round(mse, 2))) }manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
install.pakages("manipulate")
install.packages("manipulate")
library(manipulate) myHist <- function(mu){    hist(galton$child,col="blue",breaks=100) lines(c(mu, mu), c(0, 150),col="red",lwd=5) mse <- mean((galton$child - mu)^2) text(63, 150, paste("mu = ", mu))    text(63, 140, paste("MSE = ", round(mse, 2))) }manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
library(manipulate)
library(manipulate) myHist <- function(mu){    hist(galton$child,col="blue",breaks=100) lines(c(mu, mu), c(0, 150),col="red",lwd=5) mse <- mean((galton$child - mu)^2) text(63, 150, paste("mu = ", mu))    text(63, 140, paste("MSE = ", round(mse, 2))) }manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
myHist <- function(mu){    hist(galton$child,col="blue",breaks=100) lines(c(mu, mu), c(0, 150),col="red",lwd=5) mse <- mean((galton$child - mu)^2) text(63, 150, paste("mu = ", mu))    text(63, 140, paste("MSE = ", round(mse, 2))) }manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
myHist <- function(mu){hist(galton$child,col="blue",breaks=100) lines(c(mu, mu), c(0, 150),col="red",lwd=5) mse <- mean((galton$child - mu)^2) text(63, 150, paste("mu = ", mu))text(63, 140, paste("MSE = ", round(mse, 2))) }manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
mu), mu = slider(62, 74, step = 0.5))aks=100) lines(c(mu, mu), c(0, 150),col="red",lwd=5) mse <- mean((galton$child - mu)^2) text(63, 150, paste("mu = ", mu))
data(HairEyeColor)
dim(HairEyeColor)
data(iris)
dim(iris)
iris
econ
data(econ)
data(economics)
dim(economics)
economics
mtcars
?data
?datasets
data(USPop)
data(USArrests)
dim(USArrests)
USArrests
data(USJudgeRatings)
dim(USJudgeRatings)
data(USPersonalExpenditure)
dim(USPersonalExpenditure)
USPersonalExpenditure
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?isolate
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
diamons
diamonds
runApp()
runApp()
runApp()
runApp()
runApp()
g0=ggplot(mtcars,aes(x=factor(am),y=mpg,color=factor(am)))+
labs(title="Mpg by transmision")+
geom_boxplot()+
geom_point(size=6)+
scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))+
theme(plot.title=element_text(vjust=1.5,face="bold.italic",size=12),strip.text=element_text(size=12))+
xlab("Transmission")+ylab("mpg")
g0
g1=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="mpg = bo + b1*hp + b2*am + b3*hp*am")+
geom_point(size=6)+
geom_abline(intercept=coef(fit1)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2]+coef(fit1)[4],size=1,color="Blue")+
geom_line(data=grid)+
stat_smooth(method="lm",level=0.95,fullrange=TRUE)+
theme(plot.title=element_text(vjust=1.5,face="bold.italic",size=12),strip.text=element_text(size=12))+
scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))
g1
grid <- with(mtcars, expand.grid(hp = seq(min(hp),max(hp),length = 20),am=levels(factor(am))))
grid$mpg <- stats::predict(fit1, newdata=grid)
g1=ggplot(mtcars,aes(x=hp,y=mpg,color=factor(am)))+
labs(title="mpg = bo + b1*hp + b2*am + b3*hp*am")+
geom_point(size=6)+
geom_abline(intercept=coef(fit1)[1],slope=coef(fit1)[2],size=1,color="Red")+
geom_abline(intercept=coef(fit1)[1]+coef(fit1)[3],slope=coef(fit1)[2]+coef(fit1)[4],size=1,color="Blue")+
geom_line(data=grid)+
stat_smooth(method="lm",level=0.95,fullrange=TRUE)+
theme(plot.title=element_text(vjust=1.5,face="bold.italic",size=12),strip.text=element_text(size=12))+
scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))
g1
?expand.grid
seq(min(hp),max(hp),length = 20)
grid
seq(min(mtcars$hp),max(mtcars$hp),length = 20)
mtcars$hp
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
mtcars$hp
runApp()
runApp()
runApp()
runApp()
x
y
mtcars
p<-ggplot(mtcars, aes_string(x=input$x, y=mpg)) + geom_point(size=6)
p<-ggplot(mtcars, aes_string(x=mpg, y=mpg)) + geom_point(size=6)
p
p<-ggplot(mtcars, aes_string(x=cyl, y=mpg)) + geom_point(size=6)
p<-ggplot(mtcars, x=cyl, y=mpg) + geom_point(size=6)
p
runApp()
p<-ggplot(mtcars,x=input$x, y=mpg) + geom_point(size=6)
p
runApp()
input$x
runApp()
p
runApp()
runApp()
mtcars
runApp()
runApp()
runApp()
?scale_color_discrte
?scale_color_discrete
?labels
mtcars
runApp()
runApp()
?scale_color_discrete
runApp()
?geom_color
runApp()
runApp()
runApp()
?geom_color
runApp()
p<-ggplot(mtcars,aes_string(x=input$x,y="mpg",color="am")) +
geom_point(size=6) +
labs(title="Miles per galon by transmision type")+
theme(plot.title=element_text(vjust=1.5,face="bold.italic",size=12),strip.text=element_text(size=12))+
scale_color_discrete(name="Transmission",breaks=c(0,1),labels=c("Automatic", "Manual"))
p<-ggplot(mtcars,aes_string(x="cyl",y="mpg",color="am")) +
geom_point(size=6) +
labs(title="Miles per galon by transmision type")+
theme(plot.title=element_text(vjust=1.5,face="bold.italic",size=12),strip.text=element_text(size=12))+
scale_color_discrete(name="Transmission",breaks=c(0,1),labels=c("Automatic", "Manual"))
p
g0=ggplot(mtcars,aes(x=factor(am),y=mpg,color=factor(am)))+
labs(title="Mpg by transmision")+
geom_boxplot()+
geom_point(size=6)+
scale_color_discrete(name="Transmission",breaks=c("0","1"),labels=c("Automatic", "Manual"))+
theme(plot.title=element_text(vjust=1.5,face="bold.italic",size=12),strip.text=element_text(size=12))+
xlab("Transmission")+ylab("mpg")
go
g0
class(mtcars$am)
mtcars2<-factor(mtcars$am)
cass(mtcars2)
class(mtcars2)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
mtcar
class(mtcars)
str(mtcars)
?mtcars
runApp()
runApp()
runApp()
names(mtcars)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?sliderInput
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?sliderInput
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
mtcars
mtcars2<-mtcars[(mtcars$hp<300)&((mtcars$hp<60)|(mtcars$mpg<30)),]
dim(mtcars2)
dim(mtcars)
mtcars2
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
